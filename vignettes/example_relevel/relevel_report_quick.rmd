---
title: "**Factor relevelling example**"
subtitle: |
  | A Practical Foray into Lengthy Subtitle Management, Iris Dataset Tampering, 
  | and the Unceasing Pursuit of Stakeholder-Friendly Data Presentation.
  | From Markdown Mastery to Factor Finagling: 
author: 
  name: "Márton Kiss MD"
committee:
  - name: Márton Kiss MD
    position: Applied Biostatistician
date: today()
number_Sections: yes
sign_page: true
output:
  pagedown::thesis_paged: 
    # # DO NOT overwrite the default css-s! Breaks the pagination
    #  - default-fonts
    #  - default-page
    #  - styles.css
    #css:
    lof: true
    lot: true
    toc: true
    toc-title: Contents
    template:
      template_pdflike.html
  html_document:
    df_print: paged
    keep_tex: yes
    fig_caption: yes
    toc: no
    css: styles.css
bibliography: packages.bib # Causes crash??
link-citations: yes
---



# Summary {.chapter}

This is a lightweight document for me to kink out the particulars of producing serious-looking but verstile documents. Rendering for 10 minutes would be unpalatable for this document, however I wanted it to serve some useful purpose besides flaunting my template.


# Relevelling & *Forcats* {.chapter}

Factors sometimes get on my nerve. Their levels' order keep changing, you want to switch between human readable (stakeholder readable) and easy-to-type names, etc.

Take a look at the *'iris'* dataset. Species is clearly a factor.



```r
unique(iris$Species)
```

[1] setosa     versicolor virginica 
Levels: setosa versicolor virginica

Lets rename some species. The below code is a bit bloated but intuitive IMHO.


```r
library(dplyr)

iris_recode <- iris %>%
  mutate(Species_hr = 
           forcats::fct_recode( Species, 
                                 smelly = as.character(unique(iris$Species)[1]),
                                 fluffy = as.character(unique(iris$Species)[2])
                                 #Didn't recode 'virginica' asan example
                                 ))
```

And to test the results, lets see what a printout would say. Can I reference said table? Lets try (\@ref(tab:atable)):


```r
set.seed(12345)

iris_recode %>%
  .[sort(sample(nrow(.),10)),] %>% 
    knitr::kable(label = "atable",
                 # NEEDS both label and caption for referencing
                 caption = "Example cases from the recoded table")
```



Table: Example cases from the recoded table

|    | Sepal.Length| Sepal.Width| Petal.Length| Petal.Width|Species    |Species_hr |
|:---|------------:|-----------:|------------:|-----------:|:----------|:----------|
|2   |          4.9|         3.0|          1.4|         0.2|setosa     |smelly     |
|38  |          4.9|         3.6|          1.4|         0.1|setosa     |smelly     |
|51  |          7.0|         3.2|          4.7|         1.4|versicolor |fluffy     |
|58  |          4.9|         2.4|          3.3|         1.0|versicolor |fluffy     |
|75  |          6.4|         2.9|          4.3|         1.3|versicolor |fluffy     |
|86  |          6.0|         3.4|          4.5|         1.6|versicolor |fluffy     |
|93  |          5.8|         2.6|          4.0|         1.2|versicolor |fluffy     |
|96  |          5.7|         3.0|          4.2|         1.2|versicolor |fluffy     |
|142 |          6.9|         3.1|          5.1|         2.3|virginica  |virginica  |
|146 |          6.7|         3.0|          5.2|         2.3|virginica  |virginica  |

# Notes

Information regarding the compilation of this document:

<!---
Example of printing chunk stuff without the hideous '##' 
--->


```r
knitr::opts_chunk$set(comment = NA)
sessionInfo() %>% report::report() %>% cat()
```

Analyses were conducted using the R Statistical language (version 4.3.0; R Core Team, 2023) on Windows 10 x64 (build 19045), using the packages rmarkdown (version 2.22; Allaire J et al., 2023), dplyr (version 1.1.2; Wickham H et al., 2023) and pagedown (version 0.20; Xie Y et al., 2022).

References
----------
  - Allaire J, Xie Y, Dervieux C, McPherson J, Luraschi J, Ushey K, Atkins A, Wickham H, Cheng J, Chang W, Iannone R (2023). _rmarkdown: Dynamic Documents for R_. R package version 2.22, <https://github.com/rstudio/rmarkdown>. Xie Y, Allaire J, Grolemund G (2018). _R Markdown: The Definitive Guide_. Chapman and Hall/CRC, Boca Raton, Florida. ISBN 9781138359338, <https://bookdown.org/yihui/rmarkdown>. Xie Y, Dervieux C, Riederer E (2020). _R Markdown Cookbook_. Chapman and Hall/CRC, Boca Raton, Florida. ISBN 9780367563837, <https://bookdown.org/yihui/rmarkdown-cookbook>.
  - R Core Team (2023). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. <https://www.R-project.org/>.
  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. R package version 1.1.2, <https://CRAN.R-project.org/package=dplyr>.
  - Xie Y, Lesur R, Thorne B, Tan X (2022). _pagedown: Paginate the HTML Output of R Markdown with CSS for Print_. R package version 0.20, <https://CRAN.R-project.org/package=pagedown>.

This document was compiled at:


```r
Sys.time()
```

```
[1] "2023-06-28 16:03:16 CEST"
```

```r
save.image(file = here::here("inst","states","cookbook_out.Rdata"))
```


# Appendix

This is how put all your code into an appendix.


```r
knitr::opts_chunk$set(echo = TRUE,
                      fig.align = 'center',
                      warning = FALSE,
                      message = FALSE)

unique(iris$Species)

library(dplyr)

iris_recode <- iris %>%
  mutate(Species_hr = 
           forcats::fct_recode( Species, 
                                 smelly = as.character(unique(iris$Species)[1]),
                                 fluffy = as.character(unique(iris$Species)[2])
                                 #Didn't recode 'virginica' asan example
                                 ))

set.seed(12345)

iris_recode %>%
  .[sort(sample(nrow(.),10)),] %>% 
    knitr::kable(label = "atable",
                 # NEEDS both label and caption for referencing
                 caption = "Example cases from the recoded table")

knitr::opts_chunk$set(comment = NA)
sessionInfo() %>% report::report() %>% cat()

Sys.time()
save.image(file = here::here("inst","states","cookbook_out.Rdata"))

# This throws a warning everytime so lets forget about it
#| tidy=TRUE
```
